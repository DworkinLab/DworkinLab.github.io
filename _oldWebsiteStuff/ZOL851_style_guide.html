
<html> 
<head> 
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.7.0/build/reset-fonts-grids/reset-fonts-grids.css"> 
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.7.0/build/base/base-min.css"> 
  
  <script type="text/javascript" src="jquery-1.3.2.min.js"></script> 
  <script type="text/javascript"> 
  $(document).ready(function() {
      $("#nav").css("position", "absolute");
  });
  $(window).scroll(function() {
      $("#nav").animate({top: $(window).scrollTop() + "px"}, {queue: false});
  });
  </script> 
 
  <style> 
  #bd {font-size: 116%;}
  code.bad {color: red;}
 
  #yui-main h2 {
    margin-top: 2em;
    border-bottom: 1px solid #ccc;
  }
  
  h3 {font-size: 1em; margin-bottom: 0.25em; margin-top: 1.5em;}
 
  .example {
    background-color: #eee; 
    border: 1px solid #ccc;
    margin-bottom: 1em;
    font-size: 93%;
  }
  dl {margin-left: 1em;}
  dl dd {margin-left: 0; margin-bottom: 0.5em;}
  dl dt {margin-top: 1em;}
  
  #nav ul {margin-left: 0;}
  #nav ul li {list-style: none; margin-bottom: 0.5em;}
  
  </style> 
  
  <title>R style guide</title> 
  
</head> 
 
<body> 
  
<div id="doc" class="yui-t5"> 
<div id="bd"> 
<div id="yui-main"> 
<div class="yui-b"><div class="yui-g"> 
 
 
<h1>R style guide for ZOL851</h1> 

<p>This is derived from   <a href="http://had.co.nz/stat405/resources/r-style-guide.html">Hadley Wickham's  R style guide, </a> under <a  href="http://creativecommons.org/licenses/by/3.0/"> CC license </a>(thanks Hadley!).</p>  
<p>Hadley's is based on <a href="http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html">Google's R style guide.</a></p> 
 
<h2>Why is style important?</h2> 
 
<p>Good coding style is like using correct punctuation when writing: you can manage without it, but it sure makes things easier to read. As with punctuation, there are many possible variations.  The importance is in consistency.  After this class you are free to develop your own style, but these rules will make sure everybody starts off in the same place.</p> 
  
<p>Writing code for communication is important because in this class your code will have one author (you!) but multiple readers:</p> 
 
<ul> 
  <li>You, when you're writing it.</li> 
  <li>Me, Charles (and anyone else), when grading it.</li> 
  <li>Your group members, during projects.</li> 
  <li>Future you, when you look at this code in 6 months time.</li> 
</ul> 
 
<p>Make sure to read the code grading rubric thoroughly to ensure that you don't lose marks for silly mistakes.  It will be hard at first, but you'll get used to it pretty quickly.</p> 


 <!----------------------------------------------------------------------------> 
<h2>Notation and naming</h2> 
 
<h3 id="filenames">File names</h3> 
 
<p>File names should end in <code>.r</code> and be meaningful.</p> 
 
<p>When handing in an electronic copy of your assignment code, put your files in a directory called <code>firstname-lastname-hw-x</code> then upload a zip of that directory.<p> 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><code>drosophila-longevity.r</code></dd> 
    <dd><code>ian-dworkin-hw-1.r</code></dd> 
    <dt>Bad</dt> 
    <dd><code class="bad">foo.r</code></dd> 
    <dd><code class="bad">my-homework.R</code></dd> 
  </dl> 
</div> 
 
<h3 id="identifiers">Variable Identifiers</h3> 
 
<p>Variable names should be lowercase. Use <code>_</code> to separate words within a name. Generally, variable names should be nouns. Strive for concise but meaningful names (this is not easy!). When ever possible include the object class name in the variable (lm for linear model, data for dataframe, etc..). Model objects should also use this coding convention but make it clear that it is a model</p> 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><code>drosophila_longevity_data</code></dd> 
    <dd><code>model_longevity_matrix</code></dd> 
    <dd><code>drosophila_longevity_lm_1</code></dd> 
    <dt>Bad</dt> 
    <dd><code class="bad">first_day_of_the_month</code></dd> 
    <dd><code class="bad">DayOne</code></dd> 
    <dd><code class="bad">dayone</code></dd> 
    <dd><code class="bad">djm1</code></dd> 
  </dl> 
</div> 

<h3 id="identifiers">Constants Identifiers</h3> 
 
<p>constant names should be upper case, and used sparingly. Use <code>_</code> to separate words within a name, like with variable identifiers. Other than using upper case, the same rules apply for constant identifiers as for variable identifiers</p> 
 
 
<h3 id="identifiers">Function Identifiers</h3> 
 
<p>function names should be CamelCase. Use Capitalization of the first letter to separate words within a name. Generally, function names should be verbs, if possible. Strive for concise but meaningful names (this is not easy!).</p> 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><code>CoefficientVariationCalculator</code></dd> 
    <dd><code>BootstrapLinearModels</code></dd> 
    <dd><code>FindMode</code></dd> 
    <dt>Bad</dt> 
    <dd><code class="bad">find_mode</code></dd> 
    <dd><code class="bad">find.mode</code></dd> 
    <dd><code class="bad">Function1</code></dd> 
    <dd><code class="bad">djm1</code></dd> 
  </dl> 
</div> 


<!----------------------------------------------------------------------------> 
<h2>Syntax</h2> 
 
 <!----------------------------------------------------------------------------> 
<h3 id="spacing">Spacing</h3> 
 
<p>Place spaces around all binary operators (<code>=</code>, <code>+</code>, <code>-</code>, <code>&lt;-</code>, etc.). Do not place a space before a comma, but always place one after a comma.</p> 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><code> average &lt;- mean(feet / 12 + inches, na.rm = T) </code></dd> 
    <dt>Bad</dt> 
    <dd><code class="bad">average&lt;-mean(feet/12+inches,na.rm=T)</code></dd> 
  </dl> 
</div> 
 
<p>Place a space before left parentheses, except in a function call.</p> 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><code>if (debug)</code></dd> 
    <dd><code>plot(x, y)</code></dd> 
    <dt>Bad</dt> 
    <dd><code class="bad">if(debug)</code></dd> 
    <dd><code class="bad">plot (x, y)</code></dd> 
  </dl> 
</div> 
 
<p>Extra spacing (i.e., more than one space in a row) is okay if it improves alignment of equals signs or arrows (<code>&lt;-</code>).</p> 
 
<div class="example"> 
<pre> 
<code>list(
  x = call_this_long_function(a, b), 
  y = a * e / d ^ f)
</code></pre> 
<pre> 
<code>list(
  total = a + b + c, 
  mean  = (a + b + c) / n)
</code></pre> 
</div> 
 
<p>Do not place spaces around code in parentheses or square brackets. (Except if there's a trailing comma: always place a space after a comma.)</p> 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><code>if (debug)</code></dd> 
    <dd><code>diamonds[5, ]</code></dd> 
    <dt>Bad</dt> 
    <dd><code class="bad">if ( debug )  # No spaces around debug</code></dd> 
    <dd><code class="bad">x[1,]  # Needs a space after the comma</code></dd> 
    <dd><code class="bad">x[1 ,]  # Space goes after, not before</code></dd> 
  </dl> 
</div> 
 
<h3 id="curlybraces">Curly braces</h3> 
 
<p>An opening curly brace should never go on its own line and should always be followed by a new line; a closing curly brace should always go on its own line, unless followed by <code>else</code>.</p> 
 
<p>Always indent the code inside the curly braces.</p> 
 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><pre> 
<code> 
if (y &lt; 0 &amp;&amp; debug) {
  message("Y is negative")
}
 
if (y == 0) {
  log(x)
} else {
  y ^ x
}
</code></pre></dd> 
    <dt>Bad</dt> 
    <dd><pre> 
<code class="bad"> 
if (y &lt; 0 &amp;&amp; debug)
message("Y is negative")
 
if (y == 0) {
  log(x)
} 
else {
  y ^ x
}
</code></pre></dd> 
    <dd><pre> 
<code class="bad"> 
if (y &lt; 0 &amp;&amp; debug) message("Y is negative")
</code></pre></dd> 
  </dl> 
</div> 


 <!----------------------------------------------------------------------------> 
<h3 id="indentation">Indentation</h3> 
 
<p>When indenting your code, use two spaces. Never use tabs or mix tabs and spaces. </p> 
 
<h3 id="linelength">Line length</h3> 
 
<p>Keep your lines less than 80 characters.  This is the amount that will fit comfortably on a printed page at a reasonable size. If you find you are running out of room, this is probably an indication that you should encapsulate some of the work in a separate function.</p> 
 
<h3 id="assignment">Assignment</h3> 
 
<p>Use <code>&lt;-</code>, not <code>=</code>, for assignment.</p> 
 
<div class="example"> 
  <dl> 
    <dt>Good</dt> 
    <dd><code>x &lt;- 5</code></dd> 
    <dt>Bad</dt> 
    <dd><code class="bad">x = 5</code></dd> 
  </dl> 
</div> 


 <!----------------------------------------------------------------------------> 
<h2>Organization</h2> 
 
<!---------------------------------------------------------------------------->  
<h3 id="comments">Commenting guidelines</h3> 
 
<p>Comment your code. Entire commented lines should begin with <code>#</code> and one space. Comments should explain the why, not the what.</p> 
 
 
<p> Short comments can also be placed after code preceded by two spaces,
            <code>#</code>, and then one space.
          </p> 
          
          
<pre><code># Create histogram of frequency of campaigns by pct budget spent.
hist(df$pctSpent,
     breaks = &quot;scott&quot;,  # method for choosing number of buckets
     main   = &quot;Histogram: fraction budget spent by campaignid&quot;,
     xlab   = &quot;Fraction of budget spent&quot;,
     ylab   = &quot;Frequency (count of campaignids)&quot;)
</code></pre> 

</p>


<p>In general it is also important to use commented lines of <code>-</code> and <code>=</code> to break up your files into scanable chunks</p> 
 
<!---------------------------------------------------------------------------->  
 <h3 id="Organization and layout"> General Layout and Ordering</h3> 
 
<p>If everyone uses the same general ordering, we'll be able to
            read and understand each other's scripts faster and more easily.</p> 
 
<ol> 
            <li>Author comment 
            <li>File description comment, including purpose of
              program, inputs, and outputs
            <li><code>source()</code> and <code>library()</code> statements
            <li>Function definitions
            <li>Executed statements, if applicable (e.g.,
              <code> print</code>, <code>plot</code>)
          </ol> 

<!----------------------------------------------------------------------------> 

<h2>Function definitions, function calls and source files</h2> 
<h3 id="functiondefinition"><li> Function Definitions and
          Calls</li></h3> 
          <p> 
            Function definitions should first list arguments without default
            values, followed by those with default values.
          </p> 
          <p> 
            In both function definitions and function calls, multiple
            arguments per line are allowed; line breaks are only allowed
            between assignments.
            
             
<p>            <br>GOOD:
<pre><code>PredictCTR &lt;- function(query, property, numDays,
                       showPlot = TRUE)
</code></pre> 
 
           BAD:
<pre><code><span style="color:red">PredictCTR &lt;- function(query, property, numDays, showPlot =
                       TRUE)
</span></code></pre> 
          
          
        <h4 id="functiondocumentation"><li> Function Documentation </li></h4> 
          <p> Functions should contain a comments section immediately below
            the function definition line. These comments should consist of a
            one-sentence description of the function; a list of the function's
            arguments, denoted by <code>Args:</code>, with a description of
            each (including the data type); and a description of the return
            value, denoted by <code>Returns:</code>. The comments should be
            descriptive enough that a caller can use the function without
            reading any of the function's code.
 
 
        <h4 id="examplefunction"><li> Example Function </li></h4><pre><code> 
 
CalculateSampleCovariance &lt;- function(x, y, verbose = TRUE) {
  # Computes the sample covariance between two vectors.
  #
  # Args:
  #   x: One of two vectors whose sample covariance is to be calculated.
  #   y: The other vector. x and y must have the same length, greater than one,
  #      with no missing values.
  #   verbose: If TRUE, prints sample covariance; if not, not. Default is TRUE.
  #
  # Returns:
  #   The sample covariance between x and y.
  n &lt;- length(x)
  # Error handling
  if (n &lt;= 1 || n != length(y)) {
    stop(&quot;Arguments x and y have invalid lengths: &quot;,
         length(x), &quot; and &quot;, length(y), &quot;.&quot;)
  }
  if (TRUE %in% is.na(x) || TRUE %in% is.na(y)) {
    stop(&quot; Arguments x and y must not have missing values.&quot;)
  }
  covariance &lt;- var(x, y)
  if (verbose)
    cat(&quot;Covariance = &quot;, round(covariance, 4), &quot;.\n&quot;, sep = &quot;&quot;)
  return(covariance)
}
 
</code></pre>  

<p> As an alternative, you can also use the <code>comment(FunctionName) </code> function in R (which I use alot), to comment your function, so that when you (or anyone else) uses that function they can actually see the comment directly.

<p> <code> comment(CalculateSampleCovariance) <- c("Computes the sample covariance between two vectors.", <p> "Args:
  <p>   x: One of two vectors whose sample covariance is to be calculated.
 <p>    y: The other vector. x and y must have the same length, greater than one, with no missing values.
  <p>   verbose: If TRUE, prints sample covariance; if not, not. Default is TRUE." ) </code>

<p> This will allow you to see the comments directly simply by calling <code> str(FunctionName) </code>

<h2> Language </h2> 
 
       <ul class="NoBullet"> 
        <h4 id="attach"><li> Attach </li></h4> 
        <p> The possibilities for creating errors when using
          <code>attach</code> are numerous. Avoid it.
          
        <h4 id="source()"><li> source() </li></h4> 
        <p> Placing all of your functions that you use for this course in a common file is a GOOD idea. This way you can re-use it easily, and just call it by <code> source(SourceFileName)</code>. It also results in much cleaner code as we can seperate the function call from the function itself.
        
<!----------------------------------------------------------------------------> 
     <h2> Parting Words </h2> 
 
     Use common sense and BE CONSISTENT.
     <p> 
     If you are editing code, take a few minutes to look at the code around
     you and determine its style. If others use spaces around their
     <code>if </code> 
     clauses, you should, too. If their comments have little boxes of stars
     around them, make your comments have little boxes of stars around them,
     too.
     <p> 
 
     The point of having style guidelines is to have a common vocabulary of
     coding so people can concentrate on <em>what</em> you are saying,
     rather than on <em>how</em> you are saying it. We present global style
     rules here so people know the vocabulary. But local style is also important. If code you add to a file looks drastically different from the existing code around it, the discontinuity will throw readers out of their rhythm when they go to read it. Try to avoid this.
 
     OK, enough writing about writing code; the code itself is much more
     interesting. Have fun!
<!---------------------------------------------------------------------------->      

 <!----------------------------------------------------------------------------> 
<h2>References</h2> 
 
<p><a href="http://www.maths.lth.se/help/R/RCC/">http://www.maths.lth.se/help/R/RCC/</a> - R Coding Conventions<br /> 
<a href="http://ess.r-project.org/">http://ess.r-project.org/</a> - For emacs users. This runs R in your emacs and has an emacs mode. </p> 
 
</div> 
</div> 
</div> 
 
<div class="yui-b"> 
  <div id="nav"> 
    <h2>Contents</h2> 
 
    <ul> 
      <li><a href="#filenames">File names</a> end in <code>.r</code></li> 
 
      <li><a href="#identifiers">Identifiers</a> use _ to separate words</li> 
      <li>Put <a href="#spacing">spaces</a> around binary operators and after commas.</li> 
    
      <li>The first <a href="#curlybraces">curly braces</a> should go on the same line and last on its own line (unless followed by <code>else</code>).  Always indent code inside braces.</li> 
 
      <li>Use spaces, not tabs, when <a href="#indentation">indenting</a>.</li> 
 
      <li><a href="#linelength">Line length</a> should be less than 80 characters</li> 
 
      <li><a href="#assignment">Assignment</a>: use <code>&lt;-</code>, not <code>=</code></li> 
 
      <li>Use <a href="#comments">comments</a> to explain why, not what or how.</li> 
 
      <!-- <li><a href="#functiondefinition">Function definitions and calls</a></li> --> 
    </ul>  
  </div> 
</div> 
</div> 
 
</div> 
 
 
</body> 
</html> 